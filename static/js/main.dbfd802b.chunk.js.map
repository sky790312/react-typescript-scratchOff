{"version":3,"sources":["lib/ScratchOff.style.ts","lib/utils.ts","lib/ScratchOff.tsx","lib/constants.ts","playground/index.tsx","App.tsx","index.tsx"],"names":["ScratchOffContainer","styled","div","props","width","height","Canvas","canvas","ResultContainer","isCoverImageReady","CoverImg","img","getMouse","e","offsetX","offsetY","mx","my","offsetParent","offsetLeft","offsetTop","isMouseEvent","pageX","pageY","isTouchEvent","touches","clientX","clientY","x","y","simpleStringify","object","simpleObject","prop","hasOwnProperty","JSON","stringify","ScratchOff","revealPercentage","coverImgSrc","children","handleReveal","coverImgRef","useRef","canvasRef","useState","setIsCoverImageReady","useEffect","current","src","onload","isDrawing","lastPoint","ctx","getContext","brush","Image","drawImage","handleMouseDown","handleMouseMove","preventDefault","point1","point2","currentPoint","dist","Math","sqrt","pow","angle","atan2","getAngleBetween","i","sin","cos","globalCompositeOperation","stride","canvasWidth","canvasHeight","newStride","pixels","getImageData","pdata","data","l","length","total","count","round","getFilledInPixels","parentNode","removeChild","handleMouseUp","addEventListener","removeEventListener","ref","alt","crossOrigin","comparisonFn","prevProps","nextProps","memo","defaultConfig","Playground","defaultCoverImgSrc","defaultWidth","defaultHeight","defaultRevealPercentage","key","setKey","inputCoverImgSrc","setInputCoverImgSrc","inputWidth","setInputWidth","inputHeight","setInputHeight","inputRevealPercentage","setInputRevealPercentage","setCoverImgSrc","setWidth","setHeight","setRevealPercentage","useCallback","console","log","handleGenerate","generateNewKey","newRandomKey","generateRandomKey","floor","random","type","value","size","onChange","target","min","onClick","disabled","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.dbfd802b.chunk.js","sourcesContent":["import styled from 'styled-components';\n\nexport const ScratchOffContainer = styled.div<{ width: number; height: number }>`\n  position: relative;\n  margin: 0 auto;\n  width: ${props => `${props.width}px`};\n  height: ${props => `${props.height}px`};\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -o-user-select: none;\n  user-select: none;\n`;\n\nexport const Canvas = styled.canvas`\n  position: absolute;\n  top: 0;\n`;\n\nexport const ResultContainer = styled.div<{ isCoverImageReady: boolean }>`\n  visibility: ${props => (props.isCoverImageReady ? 'visible' : 'hidden')};\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  word-break: break-all;\n`;\n\nexport const CoverImg = styled.img`\n  display: none;\n`;\n","export const getFilledInPixels = (\n  stride: number,\n  ctx: CanvasRenderingContext2D,\n  canvasWidth: number,\n  canvasHeight: number,\n) => {\n  const newStride = !stride || stride < 1 ? 1 : stride;\n  const pixels = ctx.getImageData(0, 0, canvasWidth, canvasHeight);\n  const pdata = pixels?.data ?? [];\n  const l = pdata?.length ?? 0;\n  const total = l / newStride;\n  let count = 0;\n\n  for (let i = 0; i < l; i += newStride) {\n    if (+pdata[i] === 0) {\n      count++;\n    }\n  }\n\n  return Math.round((count / total) * 100);\n};\n\nexport const getMouse = (e: MouseEvent | TouchEvent, canvas: any) => {\n  let offsetX = 0;\n  let offsetY = 0;\n  let mx = 0;\n  let my = 0;\n\n  if (canvas.offsetParent) {\n    // eslint-disable-next-line no-cond-assign, no-param-reassign\n    while ((canvas = canvas.offsetParent)) {\n      offsetX += canvas.offsetLeft;\n      offsetY += canvas.offsetTop;\n    }\n  }\n\n  if (isMouseEvent(e)) {\n    mx = e.pageX - offsetX;\n    my = e.pageY - offsetY;\n  }\n\n  if (isTouchEvent(e)) {\n    mx = e.touches[0].clientX - offsetX;\n    my = e.touches[0].clientY - offsetY;\n  }\n\n  return { x: mx, y: my };\n};\n\nexport const getDistanceBetween = (\n  point1: { x: number; y: number },\n  point2: { x: number; y: number },\n) =>\n  Math.sqrt(\n    // eslint-disable-next-line no-restricted-properties\n    Math.pow(point2.x - point1.x, 2) + Math.pow(point2.y - point1.y, 2),\n  );\n\nexport const getAngleBetween = (\n  point1: { x: number; y: number },\n  point2: { x: number; y: number },\n) => Math.atan2(point2.x - point1.x, point2.y - point1.y);\n\nexport const isTouchEvent = (e: TouchEvent | MouseEvent): e is TouchEvent =>\n  e && 'touches' in e;\n\nexport const isMouseEvent = (e: TouchEvent | MouseEvent): e is MouseEvent =>\n  e && 'screenX' in e;\n\nexport const simpleStringify = (object: { [x: string]: any; hasOwnProperty: (arg0: string) => any; }) => {\n  const simpleObject: { [x: string]: any; hasOwnProperty: (arg0: string) => any; } = {};\n  for (const prop in object) {\n    if (!object.hasOwnProperty(prop)) {\n      continue;\n    }\n    if (typeof object[prop] === 'object') {\n      continue;\n    }\n    if (typeof object[prop] === 'function') {\n      continue;\n    }\n    simpleObject[prop] = object[prop];\n  }\n  return JSON.stringify(simpleObject); // returns cleaned up JSON\n}","import React, { useEffect, useRef, useState, memo } from 'react';\nimport * as S from './ScratchOff.style'\nimport {\n  getAngleBetween,\n  getDistanceBetween,\n  getFilledInPixels,\n  getMouse,\n  simpleStringify,\n} from './utils';\nimport { DEFAULT_REVEAL_PERCENTAGE, BRUSH_IMG } from './constants'\n\ninterface Props {\n  revealPercentage?: number;\n  width: number;\n  height: number;\n  coverImgSrc: string;\n  children: string | React.ReactNode;\n  handleReveal: () => void;\n}\n\nconst ScratchOff: React.FC<Props> = ({\n  revealPercentage = DEFAULT_REVEAL_PERCENTAGE,\n  width,\n  height,\n  coverImgSrc,\n  children,\n  handleReveal,\n}) => {\n  const coverImgRef = useRef<HTMLImageElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [isCoverImageReady, setIsCoverImageReady] = useState<boolean>(false);\n\n  useEffect(() => {\n    coverImgRef.current!.src = coverImgSrc;\n    coverImgRef.current!.onload = () => {\n      setIsCoverImageReady(true);\n    };\n  }, [coverImgSrc]);\n\n  useEffect(() => {\n    if (!isCoverImageReady) {\n      return;\n    }\n\n    let isDrawing: boolean;\n    let lastPoint: { x: number; y: number };\n    const canvas = canvasRef.current;\n    const ctx = canvas?.getContext('2d');\n    const brush = new Image();\n\n    brush.src = BRUSH_IMG;\n    ctx!.drawImage(coverImgRef.current!, 0, 0, width, height);\n\n    const handleMouseDown = (e: MouseEvent | TouchEvent) => {\n      isDrawing = true;\n      lastPoint = getMouse(e, canvas);\n    };\n\n    const handleMouseMove = (e: MouseEvent | TouchEvent) => {\n      if (!isDrawing) {\n        return;\n      }\n\n      e.preventDefault();\n\n      const currentPoint = getMouse(e, canvas);\n      const dist = getDistanceBetween(lastPoint, currentPoint);\n      const angle = getAngleBetween(lastPoint, currentPoint);\n      let x;\n      let y;\n\n      for (let i = 0; i < dist; i += 1) {\n        x = lastPoint.x + Math.sin(angle) * i - 25;\n        y = lastPoint.y + Math.cos(angle) * i - 25;\n        ctx!.globalCompositeOperation = 'destination-out';\n        ctx!.drawImage(brush, x, y);\n      }\n\n      lastPoint = currentPoint;\n      const currentPercentage = getFilledInPixels(32, ctx!, width, height);\n\n      if (currentPercentage > revealPercentage && canvas?.parentNode) {\n        handleReveal();\n        canvas?.parentNode.removeChild(canvas);\n      }\n    };\n\n    const handleMouseUp = () => {\n      isDrawing = false;\n    };\n\n    canvas?.addEventListener('mousedown', handleMouseDown, false);\n    canvas?.addEventListener('touchstart', handleMouseDown, false);\n    canvas?.addEventListener('mousemove', handleMouseMove, false);\n    canvas?.addEventListener('touchmove', handleMouseMove, false);\n    canvas?.addEventListener('mouseup', handleMouseUp, false);\n    canvas?.addEventListener('touchend', handleMouseUp, false);\n\n    return () => {\n      canvas?.removeEventListener('mousedown', handleMouseDown, false);\n      canvas?.removeEventListener('touchstart', handleMouseDown, false);\n      canvas?.removeEventListener('mousemove', handleMouseMove, false);\n      canvas?.removeEventListener('touchmove', handleMouseMove, false);\n      canvas?.removeEventListener('mouseup', handleMouseUp, false);\n      canvas?.removeEventListener('touchend', handleMouseUp, false);\n    };\n  }, [handleReveal, revealPercentage, height, width, isCoverImageReady]);\n\n  return (\n    <S.ScratchOffContainer width={width} height={height}>\n      <S.Canvas ref={canvasRef} width={width} height={height} />\n      <S.ResultContainer isCoverImageReady={isCoverImageReady}>\n        {children}\n      </S.ResultContainer>\n      <S.CoverImg alt=\"\" ref={coverImgRef} crossOrigin=\"anonymous\" />\n    </S.ScratchOffContainer>\n  );\n};\n\n\n\nconst comparisonFn = (prevProps: any, nextProps: any) => {\n  if (typeof prevProps?.children === 'object') {\n    const prevJSONProps = simpleStringify(prevProps?.children.props.children);\n    const nextJSONProps = simpleStringify(nextProps?.children.props.children);\n\n    return prevJSONProps === nextJSONProps;\n  }\n\n  return prevProps?.children === nextProps?.children;\n};\n\nexport default memo(ScratchOff, comparisonFn);\n","export const DEFAULT_REVEAL_PERCENTAGE = 50;\n\nexport const BRUSH_IMG =\n'data:image/jpeg;base64,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';\n","import { useCallback, useState } from 'react';\nimport { ScratchOff } from '../lib';\n\nconst defaultConfig = {\n  coverImgSrc:\n    'https://cdn.pixabay.com/photo/2015/04/19/08/32/marguerite-729510__480.jpg',\n  width: 737,\n  height: 480,\n  revealPercentage: 50,\n};\n\nconst Playground = () => {\n  const {\n    coverImgSrc: defaultCoverImgSrc,\n    width: defaultWidth,\n    height: defaultHeight,\n    revealPercentage: defaultRevealPercentage,\n  } = defaultConfig;\n\n  const [key, setKey] = useState<number>(0);\n  const [inputCoverImgSrc, setInputCoverImgSrc] =\n    useState<string>(defaultCoverImgSrc);\n  const [inputWidth, setInputWidth] = useState<number>(defaultWidth);\n  const [inputHeight, setInputHeight] = useState<number>(defaultHeight);\n  const [inputRevealPercentage, setInputRevealPercentage] = useState<number>(\n    defaultRevealPercentage,\n  );\n  const [coverImgSrc, setCoverImgSrc] = useState<string>(defaultCoverImgSrc);\n  const [width, setWidth] = useState<number>(defaultWidth);\n  const [height, setHeight] = useState<number>(defaultHeight);\n  const [revealPercentage, setRevealPercentage] = useState<number>(\n    defaultRevealPercentage,\n  );\n\n  const handleReveal = useCallback(() => {\n    console.log('handle function after reveal.');\n  }, []);\n\n  const handleResetDefault = () => {\n    setInputCoverImgSrc(defaultCoverImgSrc);\n    setInputWidth(defaultWidth);\n    setInputHeight(defaultHeight);\n    setInputRevealPercentage(defaultRevealPercentage);\n  };\n\n  const handleGenerate = () => {\n    setCoverImgSrc(inputCoverImgSrc);\n    setWidth(inputWidth);\n    setHeight(inputHeight);\n    setRevealPercentage(inputRevealPercentage);\n    generateNewKey();\n  };\n\n  const generateNewKey = () => {\n    const newRandomKey = generateRandomKey();\n    if (key === newRandomKey) {\n      generateNewKey();\n      return;\n    }\n\n    setKey(newRandomKey);\n  };\n  const generateRandomKey = () => Math.floor(Math.random() * 100);\n\n  const getDisabledState = () =>\n    !inputCoverImgSrc || !inputWidth || !inputHeight || !inputRevealPercentage;\n\n  return (\n    <div>\n      <h4>ScratchOff Card</h4>\n      <p>\n        Given the scratch card container&apos;s width and height and the cover\n        img url(relative or absolute url), the scratch off card will fit the\n        container automatically. Also, custom the result section you want(HTML\n        dom or just image..etc.).\n      </p>\n      <p>Setting the fill percentage to reveal(default 50).</p>\n      <div>\n        image url:{' '}\n        <input\n          type=\"text\"\n          value={inputCoverImgSrc}\n          size={50}\n          onChange={e => setInputCoverImgSrc(e.target.value)}\n        />{' '}\n        width:{' '}\n        <input\n          type=\"text\"\n          value={inputWidth}\n          onChange={e => setInputWidth(+e.target.value)}\n        />{' '}\n        height:{' '}\n        <input\n          type=\"text\"\n          value={inputHeight}\n          onChange={e => setInputHeight(+e.target.value)}\n        />\n      </div>\n      <p>\n        reveal percentage:{' '}\n        <input\n          type=\"number\"\n          min={1}\n          value={inputRevealPercentage}\n          onChange={e => setInputRevealPercentage(+e.target.value)}\n        />{' '}\n        <button\n          type=\"button\"\n          onClick={handleGenerate}\n          disabled={getDisabledState()}\n        >\n          generate\n        </button>{' '}\n      </p>\n      <p>\n        <button type=\"button\" onClick={handleResetDefault}>\n          reset default setting\n        </button>\n      </p>\n      <ScratchOff\n        key={key}\n        width={width}\n        height={height}\n        coverImgSrc={coverImgSrc}\n        handleReveal={handleReveal}\n        revealPercentage={revealPercentage}\n      >\n        <div>\n          <h2>Congratulations!</h2>\n          <h1>\n            <code>Coupon code : 1651613335</code>\n          </h1>\n          <div>\n            <button type=\"button\" onClick={handleGenerate}>\n              replay again\n            </button>\n            <p>\n              same as generate behavior outside(using changing key to replay.)\n            </p>\n          </div>\n        </div>\n      </ScratchOff>\n    </div>\n  );\n};\n\nexport default Playground;\n","import Playground from './playground'\n\nfunction App() {\n  return (\n      <Playground />\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}